/**
 * @author:   tony
 * @version:  v1.0.0
 * @license:  MIT
 * @name:     tPage分页插件
 */
var tPage;(function(a){tPage=function(b,c){return this.options=a.extend({},this.defaults,c),this.options.pageCount=Math.ceil(this.options.pageLimit/this.options.pageOne),this.$pageBox=b,this.init(this.options),this},tPage.prototype.defaults={pageId:null,pageOne:10,pageLimit:1,pageCount:1,pageCur:1,pageJson:{},pageJson_textName:"text",pageJson_hrefName:"href",pageEvent:function(){},pageEventInit:!1,pageAttr:"pageto"},tPage.prototype.init=function(b){this.$prev=a('<a href="javascript:void(0);" class="page-prev"><span>\u4e0a\u4e00\u9875</span></a>').attr(b.pageAttr,0>=b.pageCur-1?1:b.pageCur-1),this.$content=a("<span>"),this.$next=a('<a class="page-next" href="javascript:void(0);"><span>\u4e0b\u4e00\u9875</span></a>').attr(b.pageAttr,b.pageCur+1<=b.pageCount?b.pageCur+1:b.pageCount),this.$skip=a('<span class="page-skip"></span>'),this.$skipWords=a("<em>").text(b.pageCount),this.$skipInput=a('<input type="text" title="\u8f93\u5165\u9875\u7801" value="1" />'),this.$skipSubmit=a('<button title="\u6307\u5b9a\u9875\u7801" type="submit">\u786e\u5b9a</button>'),this.$skip.append("\u5171",this.$skipWords,"\u9875\u5230\u7b2c",this.$skipInput,"\u9875",this.$skipSubmit),this.$pageBox.append(this.$prev,this.$content,this.$next,this.$skip),this.go(b.pageCur),this.options.pageEventInit=!0;var c=this;this.$pageBox.find("a").die("click").live("click",function(){var d=parseInt(a(this).attr(b.pageAttr));d&&c.go(d)}),this.$skipSubmit.unbind("click").bind("click",function(){var a=parseInt(c.$skipInput[0].value);a!=parseInt(c.options.pageCur)&&c.go(a)}),this.$skipInput.unbind(".page").bind("input.page keydown.page",function(){this.value=this.value.replace(/[^\d.]/g,"")})},tPage.prototype.go=function(b){var c=parseInt(this.options.pageCount);return b=parseInt(b),b=0>=b?1:b,b=b>=c?c:b,b&&(this.options.pageCur=b),this.setContent(this.options),a.isFunction(this.options.pageEvent)&&this.options.pageEventInit&&this.options.pageEvent.call(this),!1},tPage.prototype.reset=function(a){this.$prev.removeClass("prev-no").attr(a.pageAttr,null),this.$next.removeClass("next-no").attr(a.pageAttr,null),this.$content.html("")},tPage.prototype.setContentArray=function(a,b,c){for(var d=[],e=a;b>=e;e++)e==c?d.push('<strong class="page-cur">'+e+"</strong>"):d.push('<a href="javascript:void(0);" '+this.options.pageAttr+'="'+e+'">'+e+"</a>");return d},tPage.prototype.setContent=function(b){this.reset(b);var c=parseInt(b.pageCur),d=parseInt(b.pageCount),e=c-2,f=c+2,g=[];f=0>=d-f?d:0>f-5?5:f,e=0>=e?1:5>f-e?f-4:e,1==c?this.$prev.addClass("prev-no"):this.$prev.attr(b.pageAttr,c-1),10>d?g=this.setContentArray(1,d,c):(0>c-6?g=a.merge(g,this.setContentArray(1,f,c)):(g.push('<a href="javascript:void(0);" '+b.pageAttr+'="1">1</a>'),g.push('<span class="page-break">...</span>'),g=a.merge(g,this.setContentArray(e,f,c))),0>c+4-d?(g.push('<span class="page-break">...</span>'),g.push('<a href="javascript:void(0);" '+b.pageAttr+'="'+d+'">'+d+"</a>")):g=a.merge(g,this.setContentArray(f+1,d,c)));var h=g.join("\n");this.$content.html(h);var i=c;c==d?this.$next.addClass("next-no"):(this.$next.attr(b.pageAttr,c+1),i+=1),this.$skipInput.val(i)},a.fn.tPage=function(b){new tPage(a(this),b)}})(jQuery);